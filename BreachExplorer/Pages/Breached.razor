@page "/breached"

<PageTitle>Was I Breached?</PageTitle>


    <div class="d-flex justify-content-center align-items-center" style="width: 100%;">
        <div class="border border-info rounded-3 bg-info bg-gradient bg-opacity-10 shadow-lg p-4"
        style="display: inline-block; text-align: center; max-width: 90%;">
            <a class="style-purple-2 text-nowrap text-decoration-none display-2" style="padding-bottom: 8px;">
                Was I Breached?
            </a>
        </div>
    </div>

    <div class="d-flex justify-content-center" style="width: 100%;">
        <a class="style-purple-1 text-opacity-75 text-white text-nowrap fw-bold fs-5">Check if your email address is in a data breach.</a>
    </div>

    <div class="d-flex justify-content-center">
        <div class="col-md-5 p-5">
            <div class="input-group">
                <input class="form-control" type="text" placeholder="Type your email..." @bind="@emailAddress">
                <button class="btn btn-primary btn-lg" type="submit" id="searchPwnage">Breached?</button>
            </div>
        </div>
    </div>

@code {
    private string emailAddress;
    private string errormessage;
    private List<BreachName> breachNamesList = new List<BreachName>();
    private List<Breach> breachesList = new List<Breach>();
    private bool success = false;

    //Breach Names for the email address specified HaveIBeenPwned API V3
    // private async Task GetBreachNamesAsync()
    // {
    //     try
    //     {
    //         string encodedEmail = Uri.EscapeDataString(emailAddress);
    //         string uri = $"https://haveibeenpwned.com/api/v3/breachedaccount/{encodedEmail}";
    //         using (HttpClient client = new HttpClient())
    //         {
    //             client.DefaultRequestHeaders.Add("hibp-api-key", "189c24e9baf0438094b05ff14e22585d");
    //             HttpResponseMessage response = await client.GetAsync(uri);
    //             response.EnsureSuccessStatusCode();
    //             breachesList = await response.Content.ReadFromJsonAsync<List<Breach>>();
    //             success = true;
    //             errormessage = String.Empty;
    //         }
    //     }
    //     catch (Exception e)
    //     {
    //         success = false;
    //         errormessage = e.Message;
    //     }
    // }

    public class Breach
    {
        public string Name { get; set; }
        public string Title { get; set; }
        public string Domain { get; set; }
        public string BreachDate { get; set; }
        public DateTime AddedDate { get; set; }
        public DateTime ModifiedDate { get; set; }
        public int PwnCount { get; set; }
        public string Description { get; set; }
        public string LogoPath { get; set; }
        public List<string> DataClasses { get; set; }
        public bool IsVerified { get; set; }
        public bool IsFabricated { get; set; }
        public bool IsSensitive { get; set; }
        public bool IsRetired { get; set; }
        public bool IsSpamList { get; set; }
        public bool IsMalware { get; set; }
        public bool IsSubscriptionFree { get; set; }
    }

    public class BreachName
    {
        public string Name { get; set; }
    }
}
